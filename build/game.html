<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <title>情人節網路告白大行動</title>
    <link href="assets/images/favicon.ico" rel="icon" type="image/x-icon" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="情人節又要到了，每個人心中一定有個特別人，如果你有段話想對她、他說，但又有不知道如何開口，交給我們來幫你吧。" />

    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/1.7.3/semantic.min.css">

    <style type="text/css">
    #wraper {
        width: 80%;
        margin: 0 auto;
    }
    .input{
        width: 100%;
        margin: 2em 0;
    }
    .login {
        text-align:center;
    }
    .flow {
        display:none;
    }
    .flow .steps {
        width: 100%;
    }
    #msg.msg, #link.link {
        display:none;
    }
    </style>

</head>

<body>

    <div id="wraper" class="ui compact segment">
        
        <h1>情人節網路告白大行動</h1>

        <ul>
            <li>- 活動說明：情人節又要到了，每個人心中一定有個特別人，如果你有段話想對她、他說，但又有不知道如何開口，交給我們來幫你吧。只要依照以下步驟，先登入臉書帳號，再輸入告白對象暱稱，並寫下一段你想對她說的話，系統會自動產出一個短網址。你只要把產出網址丟給你想要告白的對象，我們就會把你的告白內容做成網路廣告並投放給你告白對象！重點是，這段秘密對話，只有點連結的那個人看的到，其他人是看不到的喔。適用對象：不管是暗戀、單戀、情人、男男、女女、還是老夫老妻，只要你想給某人一個不一樣的情人節禮物，都可以免費參加遊戲。</li>
            <li>- 活動期間：即日起到情人節當天為止 (2/14/2015)。</li>
            <li>- 活動要求：要特別告訴告白對象，點短網址的時候要在桌機上喔，目前活動並不支援行動裝置。</li>
            <li>- 特別提示：如果想要傳給多個對象，每次都要產生新的網址喔，要不然後果可能會難以想像。</li>
            <li>- 告白廣告示意圖：300x250, 160x600, 120x600, nownews</li>
            <li>- 備註：此活動由塔圖科技贊助，塔圖科技是一間提供精准廣告投遞的廣告技術公司，如果想了解更多關於廣告投放資訊，請造訪官網：www.tagtoo.com.tw</li>
        </ul>


        
        <div class="ui horizontal divider">
            start
        </div>

        <div class="login">
            <div id="login" class="ui facebook button massive" onclick="VALENTINE.login();">
                <i class="facebook icon"></i> 大聲告白
            </div>
        </div>

        <div id="flow" class="flow">

            <div class="ui ordered steps">
                <div id="step1" class="active step">
                    <div class="content">
                        <div class="title">對誰告白</div>
                        <div class="description">輸入你想要告白的對象</div>
                    </div>
                </div>
                <div id="step2" class="disabled step">
                    <div class="content">
                        <div class="title">告白吧</div>
                        <div class="description">輸入你想要告白的內容</div>
                    </div>
                </div>
                <div id="step3" class="disabled step">
                    <div class="content">
                        <div class="title">恭喜</div>
                        <div class="description">把連結分享給你的告白對象</div>
                    </div>
                </div>
            </div>

            <div id="name" class="ui left icon action input name">
                <i class="user icon"></i>
                <input type="text" placeholder="你要告白的對象名稱">
                <div class="ui blue submit button">確認</div>
            </div>
            <div id="msg" class="ui left icon action input msg">
                <i class="smile icon"></i>
                <input type="text" placeholder="你要告白的內容">
                <div class="ui blue submit button">確認</div>
            </div>
            <div id="link" class="ui action input link">
                <input type="text" value="http://ww.short.url/c0opq">
                <div class="ui blue submit button">copy</div>
            </div>

        </div>
    </div>

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/1.7.3/semantic.min.js"></script>

    <script type="text/javascript"> 
    var VALENTINE = {
        num: 0,

        login: function () {
            FB.login(function(response) {

                if (response.authResponse) {
                    console.log('Welcome!  Fetching your information.... ');
                    //console.log(response); // dump complete info
                    access_token = response.authResponse.accessToken; //get access token
                    user_id = response.authResponse.userID; //get FB UID

                    FB.api('/me', function(response) {
                        user_email = response.email; //get user email
                        console.log(response)
                        console.log('Successful login for: ' + response.name);
                        // you can store this data into your database     
                        VALENTINE.display();        
                    });
                    FB.api('/me/picture?width=100', function(response) {
                        user_email = response.email; //get user email
                        console.log(response.data.url)
                            // console.log('Successful login for: ' + response.name);
                            // you can store this data into your database
                        VALENTINE.display();             
                    });



                } else {
                    //user hit cancel button
                    console.log('User cancelled login or did not fully authorize.');

                }
            }, {
                scope: 'publish_stream,email,user_about_me,user_photos'
            });
        },


        display: function () {
            VALENTINE.num+=1;

            if(VALENTINE.num == 2) {
                $('#login').css('display','none');
                $('#flow').css('display','block');
            }
        },

        finish: function (obj, o) {
            $(obj).removeClass('active').addClass('completed');
            $(o).css('display','none');
        },

        start: function (obj, o) {
            $(obj).removeClass('disabled').addClass('active');
            $(o).css('display','table');
        },

        nameConfirm: function (event) {
            console.log(event)
            // if(event.type == 'click' || event.which == 13 ) {            
                var name = $('#name input').val();
                var a = confirm("確定要告白的對象叫做『" + name + "』");

                if (a) {
                    VALENTINE.finish('#step1', '#name');
                    VALENTINE.start('#step2', '#msg');
                } else {
                    return false
                }
            // }
        },

        msgConfirm: function () {
            // if(event.type == 'click' || event.which == 13 ) {
                var msg = $('#msg input').val();
                var a = confirm("確定要告白的內容是『" + msg + "』");

                if (a) {
                    VALENTINE.finish('#step2', '#msg');
                    VALENTINE.start('#step3', '#link');
                } else {
                    return false
                }
            // }
        },

        copy: function () {
            // if(event.type == 'click' || event.which == 13 ) {
                $('#step3').removeClass('active').addClass('completed');
            // }
        }
    }
    
    $( "#name" ).keypress(function( event ) { if ( event.which == 13 ) { event.preventDefault(); VALENTINE.nameConfirm(); } });
    $( "#msg" ).keypress(function( event ) { if ( event.which == 13 ) { event.preventDefault(); VALENTINE.msgConfirm(); } });
    $( "#link" ).keypress(function( event ) { if ( event.which == 13 ) { event.preventDefault(); VALENTINE.copy(); } });

    $( "#name .button" ).on({
        click: VALENTINE.nameConfirm,
        keypress: VALENTINE.nameConfirm
    });

    $( "#msg .button" ).on({
        click: VALENTINE.msgConfirm,
        keypress: VALENTINE.msgConfirm
    });

    $( "#link .button" ).on({
        click: VALENTINE.copy,
        keypress: VALENTINE.copy
    });


    window.fbAsyncInit = function() {
        FB.init({
            appId: '776675399034344',
            cookie: true, // enable cookies to allow the server to access 
            // the session
            xfbml: true, // parse social plugins on this page
            version: 'v2.1' // use version 2.1
        });
    };

    // Load the SDK asynchronously
    (function(d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) return;
        js = d.createElement(s);
        js.id = id;
        js.src = "//connect.facebook.net/en_US/sdk.js";
        fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));
    </script>
</body>

</html>
